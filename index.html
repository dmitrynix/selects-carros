<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tabela FIPE</title>
  </head>
  <body>
    <form method="get" action="?" id="form2">
      <p>
        <label>Marca</label><br />
        <select name="marca" id="marca">
          <option value=''></option>
          <option value="alfa_romeo">Alfa Romeo</option>
          <option value="audi">Audi</option>
          <option value="bmw">BMW</option>
          <option value="cadillac">Cadillac</option>
          <option value="chana">CHANA</option>
          <option value="citroen">CitroÃ«n</option>
          <option value="cross_lander">Cross Lander</option>
        </select>
      </p>
      <p>
        <label>Modelo</label><br />
        <select name="model" id="model"></select>
      </p>
      <p class=" esp"><input type="submit" value="Procurar" class="btnRed btnAvalCar" /></p>
    </form>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
      $(document).ready(function(){
          $('#marca').change(function(){
            $.getJSON('/static/javascripts/models/'+$('#marca :selected').attr('value'), function(data){
              var items = '';
              $.each(data, function(idx, value) {
                items += '<option value="' + value['model'] + '">' + value['nome'] + '</option>';
              });

            $('#model').html(items);
            });
          });
      });
    </script>
  </body>
</html>
